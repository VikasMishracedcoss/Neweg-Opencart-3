<!--
/**
* CedCommerce
*
* NOTICE OF LICENSE
*
* This source file is subject to the End User License Agreement (EULA)
* that is bundled with this package in the file LICENSE.txt.
* It is also available through the world-wide-web at this URL:
* http://cedcommerce.com/license-agreement.txt
*
* @category  modules
* @package   cedebay
* @author    CedCommerce Core Team 
* @copyright Copyright CEDCOMMERCE (http://cedcommerce.com/)
* @license   http://cedcommerce.com/license-agreement.txt
*/
-->
{{ header }}{{ column_left }}
<div id="content">
  <div class="page-header">
    <div class="container-fluid">
      <div class="pull-right">
      </div>
      <h1>{{ heading_title }}</h1>
      <ul class="breadcrumb">
        {% for breadcrumb in breadcrumbs %}
          <li><a href="{{ breadcrumb['href'] }}">{{ breadcrumb['text'] }}</a></li>
        {% endfor %}
      </ul>
    </div>
  </div>
  <div class="container-fluid">
    {% if (error_warning) %}
      <div class="alert alert-danger">
        {% if (error_warning is iterable) %} {% for key,value in error_warning %}
          {{ '<span style="font-size: 12px;"><i class="fa fa-exclamation-circle"></i> '~value~'</span><br>' }} {% endfor %} {% else %}
          {{ '<i class="fa fa-exclamation-circle"></i> '~error_warning }}
        {% endif %}      <button type="button" class="close" data-dismiss="alert">&times;</button>
      </div>
    {% endif %}
    {% if (success) %}
      <div class="alert alert-success"><i class="fa fa-check-circle"></i> {{ success }}
        <button type="button" class="close" data-dismiss="alert">&times;</button>
      </div>
    {% endif %}

    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title"><i class="fa fa-list"></i> {{ text_list }}</h3>
      </div>
      <div class="panel-body">
        <div class="well">
          <div class="row">

            <div class="col-sm-3">
              <div class="form-group">
                <label class="control-label" for="input-total">Job Code</label>
                <input type="text" name="filter_job_code" value="{{ filter_job_code }}" placeholder="{{ column_total }}" id="input-total" class="form-control" />
              </div>
            </div>

            <div class="col-sm-3">
              <div class="form-group">
                <label class="control-label" for="input-date-added">Scheduled At</label>
                <div class="input-group date">
                  <input type="text" name="filter_date_added" value="{{ filter_date_added }}" placeholder="{{ column_date_added }}" data-date-format="YYYY-MM-DD" id="input-date-added" class="form-control date" />
                  <span class="input-group-btn">
                  <button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
                </div>
              </div>
            </div>

            <div class="col-sm-3">
              <div class="form-group">
                <label class="control-label" for="input-date-added">Executed At</label>
                <div class="input-group date">
                  <input type="text" name="filter_date_modified" value="{{ filter_date_modified }}" placeholder="{{ column_date_modified }}" data-date-format="YYYY-MM-DD" id="input-date-added" class="form-control date" />
                  <span class="input-group-btn">
                  <button type="button" class="btn btn-default"><i class="fa fa-calendar"></i></button></span>
                </div>
              </div>
            </div>
            <div class="col-sm-3">
              <div class="form-group" style="float: right; margin: 1.8em 9em 0 0;">
                <a onclick="filter();" class="btn btn-primary "><i class="fa fa-search"></i>{{ button_filter }}</a>
              </div>
            </div>
            </div>
          </div>
        </div>
        <form method="post" action="" id="form-order">
          <div class="table-responsive">
            <table class="table table-bordered table-hover">
              <thead>
              <tr>
                <td width="1" style="text-align: center;"><input type="checkbox" onclick="$('input[name*=\'selected\']').attr('checked', this.checked);" /></td>
                <!--td class="center">{% if (sort == 'o.order_id') %}
                    <a href="{{ sort_order }}" class="{{ (order|lower) }}">{{ column_order_id }}</a>
                  {% else %}
                    <a href="{{ sort_order }}">{{ column_order_id }}</a>
                  {% endif %}</td>
                <td class="center">{% if (sort == 'wo.newegg_order_id') %}
                    <a href="{{ sort_ebay_order_id }}" class="{{ (order|lower) }}">{{ column_ebay_order_id }}</a>
                  {% else %}
                    <a href="{{ sort_ebay_order_id }}">{{ column_ebay_order_id }}</a>
                  {% endif %}</td>
                <td class="center">{% if (sort == 'customer') %}
                    <a href="{{ sort_customer }}" class="{{ (order|lower) }}">{{ column_customer }}</a>
                  {% else %}
                    <a href="{{ sort_customer }}">{{ column_customer }}</a>
                  {% endif %}</td>
                <td class="center">{% if (sort == 'status') %}
                    <a href="{{ sort_status }}" class="{{ (order|lower) }}">{{ column_status }}</a>
                  {% else %}
                    <a href="{{ sort_status }}">{{ column_status }}</a>
                  {% endif %}</td>
                <td class="center">{% if (sort == 'wo.status') %}
                    <a href="{{ sort_wstatus }}" class="{{ (order|lower) }}">{{ column_wstatus }}</a>
                  {% else %}
                    <a href="{{ sort_wstatus }}">{{ column_wstatus }}</a>
                  {% endif %}</td> 
                <td class="center">{% if (sort == 'o.total') %}
                    <a href="{{ sort_total }}" class="{{ (order|lower) }}">{{ column_total }}</a>
                  {% else %}
                    <a href="{{ sort_total }}">{{ column_total }}</a>
                  {% endif %}</td>
                <td class="center">{% if (sort == 'o.date_added') %}
                    <a href="{{ sort_date_added }}" class="{{ (order|lower) }}">{{ column_date_added }}</a>
                  {% else %}
                    <a href="{{ sort_date_added }}">{{ column_date_added }}</a>
                  {% endif %}</td>
                <td class="center">{% if (sort == 'o.date_modified') %}
                    <a href="{{ sort_date_modified }}" class="{{ (order|lower) }}">{{ column_date_modified }}</a>
                  {% else %}
                    <a href="{{ sort_date_modified }}">{{ column_date_modified }}</a>
                  {% endif %}</td-->
                <td class="center">{{ text_job_id }}</td>
                <td class="center">{{ text_job_code }}</td>
                <td class="center">{{ text_job_Message }}</td>
                <td class="center">{{ text_job_Created }}</td>
                <td class="center">{{ text_job_Finished }}</td>
                <td class="center">{{ text_job_Status }}</td>
              </tr>
              </thead>
              <tbody>
              {% if (corn) %}
                {% for corns in corn %}
                  <tr>
                    <td style="text-align: center;">{% if (crons['selected']) %}
                        <input type="checkbox" name="selected[]" value="{{ order['id'] }}" checked="checked" />
                      {% else %}
                        <input type="checkbox" name="selected[]" value="{{ order['id'] }}" />
                      {% endif %}</td>
                    <td class="right">{{corns['id']}}</td>
                    <td class="right">{{corns['job_code']}}</td>
                    <td class="left">{{corns['message']}}</td>
                    <td class="left">{{corns['created_at']}}</td>
                    <td class="right">{{corns['finished_at']}}</td>
                    {% if (corns['status']=='1') %}
                    <td class="left">Pending</td>
                    {% else %}
                    <td class="left">Success</td>
                  {% endif %}
                 </tr>
                {% endfor %}
              {% else %}
                <tr>
                  <td class="text-center" colspan="10">{{ text_no_results }}</td>
                </tr>
              {% endif %}
              </tbody>
            </table>
          </div>
        </form>
        <div class="pagination">{{ pagination }}</div>
      </div>
    </div>
  </div>
</div>
<script type="text/javascript"><!--

  function confirmAction(href) {
    var res = confirm("Are you sure?");
    if (res == true) {
      location = href;
    }
  }

  function filter() {
    url = 'index.php?route=extension/module/cednewegg/cron&user_token={{ user_token }}';

    var filter_id = $('input[name=\'filter_id\']').val();

    if (filter_id) {
      url += '&filter_id=' + encodeURIComponent(filter_id);
    }
    var filter_id = $('input[name=\'filter_id\']').val();  

    var filter_date_added = $('input[name=\'filter_date_added\']').val();

    if (filter_date_added) {
      url += '&filter_date_added=' + encodeURIComponent(filter_date_added);
    }

    var filter_date_modified = $('input[name=\'filter_date_modified\']').val();

    if (filter_date_modified) {
      url += '&filter_date_modified=' + encodeURIComponent(filter_date_modified);
    }

    var filter_job_code = $('input[name=\'filter_job_code\']').val();

    if (filter_job_code) {
      url += '&filter_job_code=' + encodeURIComponent(filter_job_code);
    }


    location = url;
  }
  //--></script>
<script type="text/javascript"><!--
  $(document).ready(function() {
  });
  //--></script>
<script type="text/javascript"><!--
  $('#form input').keydown(function(e) {
    if (e.keyCode == 13) {
      filter();
    }
  });
  //--></script>
<script type="text/javascript"><!--

  $('input[name=\'filter_customer\']').autocomplete({
    delay: 500,
    source: function(request, response) {
      $.ajax({
        url: 'index.php?route=sale/customer/autocomplete&user_token={{ user_token }}&filter_name=' +  encodeURIComponent(request.term),
        dataType: 'json',
        success: function(json) {
          response($.map(json, function(item) {
            return {
              category: item.customer_group,
              label: item.name,
              value: item.customer_id
            }
          }));
        }
      });
    },
    select: function(event, ui) {
      $('input[name=\'filter_customer\']').val(ui.item.label);

      return false;
    },
    focus: function(event, ui) {
      return false;
    }
  });
  //--></script>
 <script src="view/javascript/jquery/datetimepicker/bootstrap-datetimepicker.min.js" type="text/javascript"></script>
<link href="view/javascript/jquery/datetimepicker/bootstrap-datetimepicker.min.css" type="text/css" rel="stylesheet" media="screen" />
<script type="text/javascript"><!--
        $('.date').datetimepicker({
            pickTime: false
        });
        //--></script>
{{ footer }}